import React, {useState, useEffect} from 'react'
export default function AdminPortal(){const [token,setToken]=useState('');const [cards,setCards]=useState([]);async function load(){const r=await fetch('/api/admin/cards',{headers:{'x-admin-token':token}});const j=await r.json();if(j.cards) setCards(j.cards)}return (<div><h3>Admin Portal</h3>{!token&&<div><input placeholder='Admin token' value={token} onChange={e=>setToken(e.target.value)}/><button onClick={load}>Enter</button></div>}{token&&<div><AddForm token={token} onDone={load}/><div className='card-grid' style={{marginTop:12}}>{cards.map(c=>(<div className='card' key={c.id}><img src={c.image}/><div><b>{c.name}</b></div><div style={{color:'#9ca3af'}}>[{c.rarity}]</div><div style={{marginTop:8}}>coins/hr: {c.coins_per_hour}</div><button onClick={async ()=>{await fetch('/api/admin/cards/'+c.id,{method:'DELETE',headers:{'x-admin-token':token}});load()}}>Delete</button></div>))}</div></div>}</div>)}

function AddForm({token,onDone}){const [name,setName]=useState('');const [rarity,setRarity]=useState('common');const [image,setImage]=useState('');const [coins,setCoins]=useState(0);return <div style={{display:'flex',gap:8,alignItems:'center'}}><input placeholder='Name' value={name} onChange={e=>setName(e.target.value)}/><select value={rarity} onChange={e=>setRarity(e.target.value)}><option>common</option><option>rare</option><option>epic</option><option>legendary</option></select><input placeholder='Image URL' value={image} onChange={e=>setImage(e.target.value)}/><input placeholder='coins/hr' value={coins} onChange={e=>setCoins(e.target.value)}/><button onClick={async ()=>{const res=await fetch('/api/admin/cards',{method:'POST',headers:{'Content-Type':'application/json','x-admin-token':token},body:JSON.stringify({name,description:'',rarity,image,coins_per_hour:Number(coins)})});const j=await res.json();if(j.card) onDone();else alert(JSON.stringify(j))}}>Add</button></div>}
