import React, {useEffect, useState} from 'react'
export default function Market(){const [list,setList]=useState([]);useEffect(()=>fetch('/api/marketplace').then(r=>r.json()).then(d=>setList(d.list)),[]);return (<div><h3>Marketplace</h3><div className='card-grid'>{list.map(it=>(<div className='card' key={it.id}><img src={it.image||'https://via.placeholder.com/300x200?text=Card'}/><div><b>{it.name}</b></div><div style={{color:'#9ca3af'}}>[{it.rarity}]</div><div style={{marginTop:8}}>{it.price} coins</div><button onClick={async ()=>{const res=await fetch('/api/marketplace/buy',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({initDataUnsafe: window.Telegram?.WebApp?.initDataUnsafe || {}, listing_id: it.id})});const j=await res.json();if(j.ok) alert('Bought');else alert(j.error)}}>Buy</button></div>))}</div></div>)}
